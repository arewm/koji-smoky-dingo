
FROM centos:7

RUN \
    yum install -ty findutils git make rpm-build yum-utils epel-release && \
    yum install -ty python-pip && \
    pip install -q nose

RUN mkdir -p /src
COPY Makefile setup.py kojismokydingo-*.tar.gz /src

RUN \
    cd /src && make srpm && \
    yum-builddep -ty /root/rpmbuild/SRPMS/kojismokydingo-*.src.rpm && \
    rpmbuild --rebuild /root/rpmbuild/SRPMS/kojismokydingo-*.src.rpm && \
    yum install -ty /root/rpmbuild/RPMS/noarch/*kojismokydingo*.rpm && \
    cd / && rm -rf /src


# The end.
